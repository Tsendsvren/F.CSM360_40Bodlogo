### Бодлого №40

### Kundu and Tree /Төрөл: Data Structures, Түвшин: Hard/

Танд N оройтой, N−1 ирмэгтэй мод (tree) өгөгдөнө. Энэ ирмэг бүр нь улаан (r) эсвэл хар (b) өнгөтэй. Багшын хүсэлт нь:

(a, b, c) гурвалжны бүх гурван зам (a→b, b→c, c→a)-д хамгийн багадаа нэг улаан ирмэг орсон байх юм. Энэ төрлийн гурвалжнуудыг (аль дарааллаар ч байсан) нэг л тоогоор тоолох ёстой.

Хариулт нь ийм гурвалжны тоо — хэрвээ 10⁹+7-оос их байвал модульд авна.

Шийдлийн санаа

Модны бүх урсах хар хэсгүүдийг (connected via black edges) салгаж авч DSU-д нэг бүлэг болгоно 

codersdaily.in

+10

hackerrank.com

+10

hackerrank.com

+10

hackerrank.com

+1

codersdaily.in

+1

DSU-н бүлгийн хэмжээ бүрийг авна (size[i]).

Мэдээж төвшингийн нийт гурвалжны тоо нь N choose 3:

mathematica

  total = N*(N-1)*(N-2)/6

Хар бүлэгт бүрдсэн гурвалжууд нь ялгаваргүй, учир:

Бүлгийн дотоод гурвалж: C(size, 3)

Бүлгийн 2 орой + бусад нэг: C(size,2)*(N-size)

Эдгээрийг огтолцуулалтгүйгээр нийлүүлэн invalid гэж үзнэ.

Эцэст нь valid = total - invalid гэж гаргана.

Mod 1e9+7 авч бодно.

Цагийн төвөгшил: O(N α(N)) (Union-Find + комбинаторик).

<p align="center">
  <img src="../image/Bodlogo40.1.png" alt="Bodlogo40.1" width="100%"/>
</p>

<p align="center">
  <img src="../image/Bodlogo40.2.png" alt="Bodlogo40.2" width="100%"/>
</p>

---

✅ **ТАЙЛАН ДУУСАВ!**